CREATE TABLE IF NOT EXISTS app (
    Key text PRIMARY KEY,
    Value TIMESTAMPTZ
);

INSERT INTO app (Key, Value) VALUES ('last commit', CURRENT_TIMESTAMP) ON CONFLICT DO NOTHING;

CREATE TABLE IF NOT EXISTS errors (
    REF text PRIMARY KEY,
    ERROR_TIME TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,
    CAUSE TEXT NOT NULL,
    TRACEBACK TEXT NOT NULL
);

-- users

CREATE TABLE IF NOT EXISTS users (
	U_UUID VARCHAR(17) PRIMARY KEY,
    USR_NAME VARCHAR(60) NOT NUll,
--    FULL_NAME VARCHAR(100) NOT NULL, -- not implemented
    EMAIL VARCHAR(255) NOT NULL,
    PASS_KEY VARCHAR(255) NOT NULL UNIQUE,
    IS_VERIFIED BOOLEAN DEFAULT FALSE,
    PHONE VARCHAR(11) NOT NULL,
--    DELIVERY_ADDRESS JSON, -- not implemented
--    PREFERENCES JSON, -- not implemented
    AVATAR VARCHAR(30),
    JOINED_AT TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,
--    UPDATED_AT TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP, -- not implemented
--    LAST_LOGIN TIMESTAMPTZ, -- not implemented
	Active BOOLEAN DEFAULT TRUE,
    IS_SUPER_USR BOOLEAN DEFAULT FALSE
);